@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model Pacem.Js.CustomElements.Models.ViewModel
@{
    string pacemjs_version = Model.Version;
    string version = pacemjs_version + "." + Model.Refresh;
    string img = "https://pacem.azureedge.net/marketing/logojs_800x800.png";
    string title = "Pacem JS";
    string desc = "Pacem JS is a CustomElements-v1 based ecosystem for reusable web components.";

    if (!Context.Request.Query.TryGetValue("prefix", out var P))
    {
        P = "pacem";
    }
    string PCSS = P;
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>@title</title>
    <meta name="og:title" content="@title" />
    <meta name="twitter:title" content="@title" />
    <link rel="shortcut icon" href="~/favicon.ico" />
    <meta name="description" content="@desc" />
    <meta itemprop="description" content="@desc" />
    <meta name="twitter:description" content="@desc" />
    <meta name="og:description" content="@desc" />
    <meta name="keywords" content="Pacem JS,Web Components v1,JavaScript Framework,TypeScript,ES6,ES2017,Pacem,Cristian Merighi,Merighi" />
    <meta name="image" content="@img" />
    <meta itemprop="image" content="@img" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="@img" />
    <meta name="og:image" content="@img" />
    <meta name="twitter:creator" content="@@pacem_it">
    <meta name="og:locale" content="en_us" />
    <meta name="og:type" content="website" />
    <script>
        (function (global) {
            global.Pacem = Object.assign(global.Pacem || {}, { Configuration: { prefix: "@(P)" }});
        })(window);
    </script>
    <environment include="Development">
        <script src="~/polyfills/documentfragment.edge.js"></script>
        <script src="~/polyfills/custom-elements.min.js"></script>
        <script src="~/dist/js/pacem-core.js"></script>
        <script src="~/dist/js/pacem-ui.js"></script>
        <script src="~/dist/js/pacem-scaffolding.js"></script>
        <script src="~/dist/js/pacem-logging.js"></script>
        <script src="~/dist/js/pacem-plus.js"></script>
        <script src="~/dist/js/pacem-fx.js"></script>
        @*<script src="~/dist/js/pacem-3d.js" asp-append-version="true"></script>*@
        <script src="~/dist/js/pacem-maps.js"></script>
        <script src="~/dist/js/pacem-charts.js"></script>
    </environment>
    <environment exclude="Development">
        <script src="//pacem.azureedge.net/pacemjs/polyfills/documentfragment.edge.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/polyfills/custom-elements.min.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-core.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-logging.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-ui.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-scaffolding.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-charts.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-maps.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-fx.js" pacem-distinct="src"></script>
        <script src="//pacem.azureedge.net/pacemjs/v@(pacemjs_version)/js/pacem-plus.js" pacem-distinct="src"></script>
    </environment>
    @*<link href="~/dist/css/pacem-phousys.min.css" rel="stylesheet" />
        <link href="~/dist/css/pacem-docs-phousys.min.css" rel="stylesheet" />*@
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous" />
    @*    <script src="~/dist/js/less.min.js"></script>*@
    <script src="~/dist/js/demo/pacem-js.js"></script>
    <meta name="theme-color" content="#090c41" />
    <link href="/manifest.json" rel="manifest" />

</head>
<body class="@(PCSS)-body @(PCSS)-animations @(PCSS)-animatable">

    <@(P)-annihilator>
        <img src="@img" alt="Pacem JS" />
    </@(P)-annihilator>

    <@(P)-data id="themes" model="[{label: 'Light', value: 'light'}, {label: 'Dark', value: 'dark'}, {label: 'Tech', value: 'phousys'}]"></@(P)-data>
    <@(P)-data id="themename" model="'light'" persist-as="theme@(version)"></@(P)-data>
    <@(P)-data id="theme" model="{{ #themes.model.find(_ => _.value === #themename.model) }}"></@(P)-data>
    <@(P)-data id="route" model="{{ #menu.result && #menu.result.find(_ => _.package === #router.state.package).items.find(_ => _.view === #router.state.view) }}"></@(P)-data>
    <@(P)-data id="routetitle" model="{{ (#route.model && (#route.model.title || #route.model.label)) || #router.state.view }}"></@(P)-data>

    <@(P)-title-proxy value="{{ #routetitle.model + ' | Pacem JS' }}"></@(P)-title-proxy>
    <@(P)-meta-proxy content="{{ #routetitle.model }}" name="og:title"></@(P)-meta-proxy>
    <@(P)-meta-proxy content="{{ #routetitle.model }}" name="twitter:title"></@(P)-meta-proxy>
    <@(P)-style-proxy src="{{ '/dist/css/@(P)-'+ #themename.model +'.min.css?v=@(version)' }}"></@(P)-style-proxy>
    <@(P)-style-proxy src="{{ '/dist/css/@(P)-docs-'+ #themename.model +'.min.css?v=@(version)' }}"></@(P)-style-proxy>

    <header class="header-border" pacem>
        <div class="@(PCSS)-breadcrumbs">
            <@(P)-button class="breadcrumb home dropdown-toggle" id="selector" css-class="{{ { 'dropdown-open': #ddl.visible } }}">
                <span class="breadcrumb-extra">ver. @(pacemjs_version)</span>
                <@(P)-text text="{{ 'theme: '+ #theme.model.label }}" class="breadcrumb-detail"></@(P)-text>
                <@(P)-img class="breadcrumb-main" adapt="contain" src="{{ '/assets/logo-'+ #themename.model +'.svg' }}"></@(P)-img>
            </@(P)-button>

            <@(P)-panel class="breadcrumb hide-md hide-v" css-class="{{ {'active': #router.state != null } }}">
                <span class="breadcrumb-extra">Pacem JS</span>
                <@(P)-text class="breadcrumb-detail text-capital" text="{{ #router.state.package }}"></@(P)-text>
                <@(P)-span class="breadcrumb-main text-accent" css-class="{{ {'text-tech': #routetitle.model && #routetitle.model.startsWith('<') } }}"
                           text="{{ #routetitle.model }}"></@(P)-span>
            </@(P)-panel>
        </div>
    </header>

    <!-- dropdown balloon and adapter -->
    <@(P)-adapter id="adapter" hide="true" orientation="vertical"></@(P)-adapter>
    <@(P)-balloon options="{{ { trigger:'click', align: 'start', trackPosition: true, size: 'match' } }}" target="#selector" id="ddl"
                  on-popup="#buttonset.index = -1; #buttonset.focus(); #collapse.collapse = false"
                  on-popout="#collapse.collapse = true"
                  class="balloon-border balloon-corners">
        <div class="@(PCSS)-panel balloon-panel panel-primary">
            <div class="panel-heading heading-sever @(PCSS)-grid">

                <div class="@(PCSS)-cell cols-4">
                    Version
                </div>
                <div class="@(PCSS)-cell cols-8 text-nowrap">
                    Theme
                </div>

            </div>
            <div class="panel-body">
                <div class="@(PCSS)-grid">
                    <div class="@(PCSS)-cell cols-4">
                        v@(pacemjs_version)
                    </div>
                    <div class="@(PCSS)-cell cols-8 text-nowrap">
                        <@(P)-radio-list datasource="{{ #themes.model }}"
                                         value="{{ #theme.model }}"
                                         on-change="#themename.model = $this.value.value; #ddl.popout()"
                                         text-property="label"></@(P)-radio-list>
                    </div>
                </div>
            </div>
        </div>
    </@(P)-balloon>
    <!-- /dropdown balloon and adapter -->

    <@(P)-data id="m_open" persist-as="menu_open"></@(P)-data>
    <@(P)-repeater id="menu_rep" datasource="{{ #menu.result }}">
        <@(P)-menu open="{{ #m_open.model, twoway }}" aside header footer>
            <@(P)-a id="add-to-home" href="#" class="@(PCSS)-button" hidden>Install PWA App</@(P)-a>
            <template>

                <@(P)-panel class="menu-group" css-class="{{ {'group-active': #router.state.package === ^item.package, 'collapsed': ^item.collapsed, 'item-space item-separate': ^index > 0 } }}">
                    <i class="@(PCSS)-icon @(PCSS)-animatable">keyboard_arrow_down</i>
                    <@(P)-button class="flat" on-click="#menu_rep.datasource.splice(^index, 1, Pacem.Utils.extend({}, ^item, { collapsed: !^item.collapsed}))">
                        <@(P)-text text="{{ ^item.label }}"></@(P)-text>
                    </@(P)-button>
                </@(P)-panel>
                <@(P)-collapse collapse="{{ ^item.collapsed }}">
                    <@(P)-repeater datasource="{{ ^item.items }}">
                        <template>
                            <div class="@(PCSS)-menu-item">
                                <@(P)-a href="{{ '/'+ ^^item.package +'/'+ ^item.view }}"
                                        router="{{ #router }}"
                                        css-class="{{ {'item-active': #router.state.package === ^^item.package && #router.state.view === ^item.view } }}">
                                    <@(P)-text text="{{ ^item.label }}"></@(P)-text>
                                </@(P)-a>
                            </div>
                        </template>
                    </@(P)-repeater>
                </@(P)-collapse>

            </template>
        </@(P)-menu>
    </@(P)-repeater>

    <@(P)-router template="/{package}/{view}" path="/@(Model.Package ?? "intro")/@(Model.View ?? "start")" id="router"></@(P)-router>

    <h1 class="text-accent show-v" id="heading">
        <@(P)-span css-class="{{ {'text-tech': #routetitle.model && #routetitle.model.startsWith('<') } }}"
                   text="{{ #routetitle.model }}">Pacem JS -@Model.Title</@(P)-span>
            </h1>
            <@(P)-view id="view" url="{{ '/demo/'+ #router.state.package + '/'+ #router.state.view +'.html?v=@(version)' }}" class="@(PCSS)-animatable"></@(P)-view>

            <div class="toc hide-v hide-md">
                <h3>TOC <i class="@(PCSS)-icon">keyboard_arrow_down</i></h3>
                <@(P)-toc id="toc" selector="h2" target="{{ #view }}" offset="108"></@(P)-toc>
            </div>

            <footer class="footer-border" pacem>
                <span>Copyright @(DateTime.UtcNow.Year) - <a href="https://pacem.it" target="_blank">Pacem</a></span>
            </footer>

            <script>
        var pacemdocs = window['pacemdocs'] = window['pacemdocs'] || {};
        // Service Worker registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker
                .register('/sw.js')
                .then(function () {
                    console.log("Service Worker v@(version) registered.");
                });
        }
            </script>

            <@(P)-fetch url="/menu.json?v=@(version)" id="menu" on-fetchresult="pacemdocs.menu = $event.detail"></@(P)-fetch>

        </body>
    </html>