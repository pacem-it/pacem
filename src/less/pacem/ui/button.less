@import "../../shared";
@import "../theme-dark";
@import "shared";

@_side_padding: @grid_spacing / 2;
@_margin: @grid_spacing/3;
@_width: 2 * (@grid_cell + @_side_padding);
@_height: @grid_spacing * 1.5;
@_border: 1px;

.@{PCSS}-button.button,
@{P}-button.button {
    @_brd: @_border;
    @_h: @_height;
    height: @_h - 2 * @_brd;
    line-height: @_h - 2 * @_brd;
    padding: 0 @grid_spacing/1.5;
    //min-width: @_width;
    background-color: @color_button_back;
    box-sizing: border-box;
    cursor: pointer;
    border: @_brd solid transparent;
    //margin: 0 @_margin @_margin 0;
    transition: all .1s linear;
    //color: @color_light;
    border-radius: @border_radius;

    &.button-size {
        padding: 0 @grid_spacing/2;
        min-width: @_width;
    }
}

.ButtonShadows() {
    box-shadow: 0 2px @grid_spacing / 3 rgba(0,0,0,0.5);
}

.ButtonGradients() {
    .GradientBorderVertical(1, 0, 100%, @color_button_border_light, @color_button_border_dark);
}

.ButtonNoGradients() {
    border-top-color: @color_button_border_light;
    border-bottom-color: @color_button_border;
    border-right-color: @color_button_border;
    border-left-color: @color_button_border;
}

.@{PCSS}-button.button when (@shadows = true) {
    .ButtonShadows();
}

@{P}-button.button when (@shadows = true) {
    .ButtonShadows();
}

.@{PCSS}-button.button when (@gradients = true) {
    .ButtonGradients();
}

@{P}-button.button when (@gradients = true) {
    .ButtonGradients();
}

.@{PCSS}-button.button when (@gradients = false) {
    .ButtonNoGradients();
}

@{P}-button.button when (@gradients = false) {
    .ButtonNoGradients();
}

.@{PCSS}-button,
a.@{PCSS}-button,
@{P}-button {
    position: relative;
    cursor: pointer;
    display: inline-block;
    vertical-align: middle;
    background-color: @color_button_back;
    margin: 0 @_margin @_margin 0;
    color: @color_button_fore;
    user-select: none;

    &:focus when (@glows = true) {
        text-shadow: 0 0 8px @color_button_fore;
    }

    &:hover when (@glows = true) {
        text-shadow: 0 0 8px @color_button_fore;
    }

    @_darken_perc: @button_hover_percentage;

    &:focus when (@dark_theme = false) {
        background-color: darken(@color_button_back, @_darken_perc);
    }

    &:hover when (@dark_theme = false) {
        background-color: darken(@color_button_back, @_darken_perc);
    }

    &:focus when (@dark_theme = true) {
        background-color: lighten(@color_button_back, @_darken_perc);
    }

    &:hover when (@dark_theme = true) {
        background-color: lighten(@color_button_back, @_darken_perc);
    }

    &.accent,
    &.button-accent {
        background: @color_accent;
        color: @color_accent_inv;

        &:focus,
        &:hover {
            background: darken(@color_accent, @_darken_perc);
            color: @color_accent_inv;
        }

        &:focus when (@glows = true) {
            text-shadow: 0 0 8px @color_accent_inv;
        }

        &:hover when (@glows = true) {
            text-shadow: 0 0 8px @color_accent_inv;
        }
    }

    &.primary,
    &.button-primary {
        background: @color_primary;
        color: @color_primary_inv;

        &:focus,
        &:hover {
            color: @color_primary_inv;
            background: darken(@color_primary, @_darken_perc);
        }

        &:focus when (@glows = true) {
            text-shadow: 0 0 8px @color_primary_inv;
        }

        &:hover when (@glows = true) {
            text-shadow: 0 0 8px @color_primary_inv;
        }
    }

    &.danger,
    &.button-danger {
        background: @color_danger;
        color: @color_danger_inv;

        &:focus,
        &:hover {
            color: @color_danger_inv;
            background: darken(@color_danger, @_darken_perc);
        }

        &:focus when (@glows = true) {
            text-shadow: 0 0 8px @color_danger_inv;
        }

        &:hover when (@glows = true) {
            text-shadow: 0 0 8px @color_danger_inv;
        }
    }

    &.success,
    &.button-success {
        background: @color_success;
        color: @color_success_inv;

        &:focus,
        &:hover {
            color: @color_success_inv;
            background: darken(@color_success, @_darken_perc);
        }

        &:focus when (@glows = true) {
            text-shadow: 0 0 8px @color_success_inv;
        }

        &:hover when (@glows = true) {
            text-shadow: 0 0 8px @color_success_inv;
        }
    }

    &.warning,
    &.button-warning {
        background: @color_warning;
        color: @color_warning_inv;

        &:focus,
        &:hover {
            color: @color_warning_inv;
            background: darken(@color_warning, @_darken_perc);
        }

        &:focus when (@glows = true) {
            text-shadow: 0 0 8px @color_warning_inv;
        }

        &:hover when (@glows = true) {
            text-shadow: 0 0 8px @color_warning_inv;
        }
    }

    &.exhalt,
    &.button-exhalt {
        background: @color_highlight;
        color: @color_highlight_fore;

        &:focus,
        &:hover {
            color: @color_highlight_fore;
            background: darken(@color_highlight, @_darken_perc);
        }

        &:focus when (@glows = true) {
            text-shadow: 0 0 8px @color_highlight_fore;
        }

        &:hover when (@glows = true) {
            text-shadow: 0 0 8px @color_highlight_fore;
        }
    }

    &.flat,
    &.button-flat {
        background: transparent;
    }

    &.rise,
    &.button-rise {
        /*box-shadow: none;
        border-image: none;*/
        box-shadow: 0 2px @grid_spacing / 3 rgba(0,0,0,0.5);
        margin: 0 @_margin @_margin 0;
    }

    &::before {
        line-height: 1;
        text-align: center;
        .IconCore();
        font-size: @grid_spacing;
    }

    &.add::before {
        content: 'add';
    }

    &.remove::before {
        content: 'remove';
    }

    &.edit::before {
        content: 'edit';
    }

    &.save::before {
        content: 'save';
    }

    &.check::before {
        content: 'check';
    }

    &.clear::before {
        content: 'clear';
    }

    &.delete::before {
        content: 'delete';
    }

    &.copy::before {
        content: 'file_copy';
    }

    &.toggle {

        &::before {
            transition: transform @easing_in_out_sine .333s;
            overflow: hidden;
        }

        &.fullscreen::before {
            content: 'fullscreen';
        }

        &.fullscreen-exit::before {
            content: 'fullscreen_exit';
        }

        &.expand::before {
            content: 'expand_more';
            transform: rotate(0);
        }

        &.collapse::before {
            content: 'expand_more';
            transform: rotate(-180deg);
        }
    }

    &.circular,
    &.button-circular,
    &.button-circle {
        border-radius: 50%;
        width: 2 *@grid_spacing;
        height: $width;
        font-size: 0;

        &::before {
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -@grid_spacing/2;
            margin-left: -@grid_spacing/2;
        }

        &.circle-small {
            width: 1.5 *@grid_spacing;
            height: $width;

            &::before {
                font-size: @grid_spacing * .75;
                margin-top: -@grid_spacing * (1.5 - .75)/2;
                margin-left: $margin-top;
            }
        }

        &.circle-smaller {
            width: @grid_spacing;
            height: $width;

            &::before {
                font-size: @grid_spacing * .5;
                margin-top: -@grid_spacing * (0.5)/2;
                margin-left: $margin-top;
            }
        }
    }
}

@{P}-button, .@{PCSS}-button {
    /*&.@{PCSS}-focus when (@gradients = true) {
        .GradientBorderVertical(1, 0, 100%, fade(@color_button_border_light, 20), fade(@color_button_border, 0));
    }*/
    &:focus when (@gradients = true) {
        .GradientBorderVertical(1, 0, 100%, fade(@color_button_border_light, 20), fade(@color_button_border, 0));
    }
    /*&.@{PCSS}-focus when (@gradients = false) {
        border-bottom-color: @color_button_border_dark;
    }*/
    &:focus when (@gradients = false) {
        border-bottom-color: @color_button_border_dark;
    }

    &.@{PCSS}-active {
        //border-image: none;
        transform: translateY(@_border);
        box-shadow: none;
    }

    &.@{PCSS}-active when (@gradients = true) {
        .GradientBorderVertical(1, 0, 100%, fade(@color_button_border_dark, 10), fade(@color_button_border_light, 10));
    }

    &.@{PCSS}-active when (@gradients = false) {
        border-top-color: @color_button_border;
        border-bottom-color: @color_button_border_light;
    }
}

.ButtonText() {
    cursor: pointer;
    // picked from below
    font-family: @button_fontfamily;
    font-size: @button_fontsize;
    text-align: center;
}

//:host

.@{PCSS}-button,
@{P}-button {
    .ButtonText();
}

@{P}-button when (@uppercase_buttons = true) {
    text-transform: uppercase;
}

.@{PCSS}-button when (@uppercase_buttons = true) {
    text-transform: uppercase;
}

//:host([disabled]),
.@{PCSS}-button.@{PCSS}-disabled,
.@{PCSS}-button[disabled],
@{P}-button.@{PCSS}-disabled,
.@{PCSS}-button.@{PCSS}-disabled:hover,
.@{PCSS}-button[disabled]:hover,
@{P}-button.@{PCSS}-disabled:hover {
    cursor: default;
    color: fade(@color_button_fore, 30);
    text-shadow: none;
    pointer-events: none;
}

.@{PCSS}-button,
@{P}-button,
.@{PCSS}-button:hover,
@{P}-button:hover {
    color: inherit;

    &.@{PCSS}-disabled {
        background-color: @color_button_back;
        cursor: default;
    }

    &.@{PCSS}-disabled when (@gradients = true) {
        .GradientBorderVertical(1, 0, 50%, fade(@color_button_border_light, 10), fade(@color_button_border, 0));
        //border-color: transparent;
    }

    &.@{PCSS}-disabled when (@shadows = true) {
        box-shadow: 0 2px 2px rgba(0,0,0,0.1);
    }

    &.@{PCSS}-disabled when (@gradients = false) {
        //border-color: #f0f0f0;
        border-color: transparent;
    }
}

/* #endregion */
body.pacem-animations {
    .@{PCSS}-button, a.@{PCSS}-button, @{P}-button {
        transition: background .15s;
    }
}

@{P}-buttonset {
    display: block;
    border: 4px solid transparent;
    transition: border .25s linear;
    position: relative;

    &:focus {
        border-color: @color_suggest_border;
    }
    /*&:focus::before{
        .Icon('keyboard_arrow_down');
        color: @color_primary;
        top: -@grid_spacing;
        left: 50%;
        margin-left: -@grid_spacing/2;
        animation: shooting-star .4s linear both;
        //z-index: 2;
    }*/
}

.@{PCSS}-buttonset {
    .HorizontalItemSet(button);
    padding: @grid_spacing/2 0 0 0;

    &.buttons when (@shadows = true) {
        .@{PCSS}-buttonset-left, .buttonset-left,
        .@{PCSS}-buttonset-center, .buttonset-center,
        .@{PCSS}-buttonset-right, .buttonset-right {
            .ButtonShadows();
        }
    }

    @{P}-button,
    .@{PCSS}-button {
        .HorizontalItem(button);
        margin: 0;
        box-shadow: none;
    }
}

.@{PCSS}-contextmenu {
    margin: 0;
    padding: 0;

    @{P}-button,
    .@{PCSS}-button {

        @_side_pad: @grid_spacing * 1.25;
        @_v_pad: @grid_spacing * .5;

        display: block;
        margin: 0;
        padding: @_v_pad @_side_pad;
        box-shadow: none;
        border: none;
        background: transparent;
        height: auto;
        line-height: 1;
        .FontStd(1);
        border-radius: 0;
        text-transform: none;
        text-align: left;
        width: @grid_spacing * 5;
        .Ellipsed();

        &::before {
            font-size: 1em;
            width: @_side_pad;
            text-align: center;
            position: absolute;
            left: 0;
            top: @font_icon_offset + @_v_pad;
            content: '';
        }

        &:hover,
        &:focus {

            &:not(.@{PCSS}-disabled) {
                background-color: @color_contextmenu_hover_back;
                color: @color_contextmenu_hover_fore;
            }

            &.@{PCSS}-disabled {
                background-color: transparent;
            }
        }
    }

    hr {
        border: 0;
        border-bottom: 1px solid fade(@color_default, 50);
        margin: @grid_spacing / 6 @grid_spacing / 8;
    }
}
// icon injection
@{P}-button,
.@{PCSS}-button {

    &[data-icon-glyph]::before {
        content: attr(data-icon-glyph);
    }

    &[data-icon-url]::before {
        // will work in a far future
        content: attr(data-icon-url url);
    }
}

@{P}-button.dropdown-toggle {
    padding-right: 1.5 * @grid_spacing;
    margin-bottom: 0;
    position: relative;

    &::after {
        .Icon('arrow_drop_down');
        right: .25 * @grid_spacing;
        //top: .5 * (@_height - @grid_spacing) - @_border;
        top: 50%;
        margin-top: -@grid_spacing/2;
        transition: transform .25s @easing_in_out_sine;
    }

    &.dropdown-open::after {
        transform: rotate(-180deg);
    }
}

@{P}-button.dropdown-item {
    display: block;
    margin: 0;
    height: @_height;
    line-height: @_height;
    border-top: 1px solid @color_suggest_border_light;
    border-bottom: 1px solid @color_suggest_border_dark;

    &.selected {
        background-color: @color_accent;
        color: @color_accent_inv;
    }

    &:hover,
    &:focus {
        background-color: @color_suggest_focus_back;
        color: @color_suggest_focus_fore;
    }
}
